1-¿Qué orden pondrías en crontab en los siguientes casos?

La tarea se ejecuta cada hora
```bash
17 *  * * * tarea
```

La tarea se ejecuta los domingos cada 3 horas
```bash
30 */3  * * 7 tarea
```

La tarea se ejecuta a las 12 de la mañana los días pares del mes.
```bash
0 12 */2 * * tarea
```

La tarea se ejecuta el primer día de cada mes a las 8 de la mañana y a las 8 de la tarde.
```bash
0 8,20  1 * * tarea
```

La tarea se ejecuta cada media hora de lunes a viernes.
```bash
*/30 *  * * 1-5 tarea
```

La tarea se ejecuta cada cuarto de hora, entre las 3 y las 8, de lunes a viernes, durante todo el mes de agosto
```bash
*/15 3-8  * 8 1-5 tarea
```

La tarea se ejecuta cada 90 minutos
```bash
0 */3  * * * tarea 
30 1,4,7,10,13,16,19,22  * * * tarea
```

2-¿Cómo compruebas si el servicio cron se está ejecutando?

Localizando el proceso de cron con el comando:
```bash
 $ ps auxw | grep cron
```
Y viendo si está en ejecución.

3-¿Cuál es el efecto de la siguiente línea crontab?
```bash
*/15 1,2,3 * * * who > /tmp/test
```
Cada cuarto de hora de cada una de las 3 primeras horas del día el contenido del fichero who se añade al final del fichero /tmp/test. Es para tener un registro de quién usa el sistema.

1-Indica la ruta del fichero crontab del sistema

```bash
/etc/crontab
```

2-¿Qué ficheros controlan los usuarios que pueden utilizar el crontab?

cron.allow y cron.deny

3-Excepcionalmente se debe iniciar una tarea llamada script.sh todos los lunes a las 07:30h antes de entrar en clase ¿Cómo lo harías?

Como usuario hago crontab -e y añado la línea:
```bash
30 7  * * 1 script.sh
```

4-Se ha cancelado la tarea. ¿Cómo listar y luego, suprimir la tarea?

crontab -l lista las tareas programadas y crontab -r borra las tareas programadas.

5-Ejecuta el comando ps -ef para el usuario root cada 2 minutos y redirecciona el resultado a /tmp/ps_result sin sobrescribir los antiguos.

```bash
*/2 *  * * *  root  ps -ef > /tmp/ps_result
```

6-Verifica la lista de tareas en crontab

Uso crontab -l:
```bash
cesar@crb-server:~$ crontab -l
# Edit this file to introduce tasks to be run by cron.
#
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
#
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '*' in these fields (for 'any').
#
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
#
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
#
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
#
# For more information see the manual pages of crontab(5) and cron(8)
#
# m h  dom mon dow   command
*/2 *  * * *  ps -ef > /tmp/ps_result
cesar@crb-server:~$
```

7-Espera unos minutos y comprueba el resultado en /tmp

```bash
cesar@crb-server:~$ cat /tmp/ps_result
UID          PID    PPID  C STIME TTY          TIME CMD
root           1       0  2 07:01 ?        00:00:03 /sbin/init
root           2       0  0 07:01 ?        00:00:00 [kthreadd]
root           3       2  0 07:01 ?        00:00:00 [pool_workqueue_release]
root           4       2  0 07:01 ?        00:00:00 [kworker/R-rcu_g]
root           5       2  0 07:01 ?        00:00:00 [kworker/R-rcu_p]
root           6       2  0 07:01 ?        00:00:00 [kworker/R-slub_]
root           7       2  0 07:01 ?        00:00:00 [kworker/R-netns]
root           8       2  0 07:01 ?        00:00:00 [kworker/0:0-events]
root           9       2  0 07:01 ?        00:00:00 [kworker/0:1-rcu_gp]
root          10       2  0 07:01 ?        00:00:00 [kworker/0:0H-kblockd]
root          11       2  0 07:01 ?        00:00:00 [kworker/u2:0-flush-8:0]
root          12       2  0 07:01 ?        00:00:00 [kworker/R-mm_pe]
...
```

8-Crea el usuario asir2 y prohíbele utilizar el crontab.

```bash
cesar@crb-server:~$ sudo adduser asir2
cesar@crb-server:/etc$ sudo touch cron.deny
cesar@crb-server:/etc$ sudo nano cron.deny
asir2
```

9-Verifica que el usuario asir2 realmente no puede utilizar crontab

```bash
asir2@crb-server:~$ crontab -e
You (asir2) are not allowed to use this program (crontab)
See crontab(1) for more information
asir2@crb-server:~$
```

10-Programa crontab para que cada día a las 0:05 se eliminen todos los ficheros que se encuentran en el directorio /tmp.

```bash
5 0  * * *  rm -rf /tmp/*
```

11-Programa una tarea en el sistema que se lance de lunes a viernes a las 9 de la mañana durante los meses de verano (julio, agosto y septiembre) que escriba en un fichero la hora actual (comando date, aunque tienes que mirar la ayuda para elegir un formato comprensible) seguido del listado de usuarios que hay conectados en ese momento en el sistema (comando who)

```bash
0 9  * 7-9 1-5  (echo "$(date '+%Y-%m-%d %H:%M:%S')" && who) > file
```

12-El servicio cron se ayuda de una serie de ficheros y directorios que se encuentran en el directorio /etc. Explica la función de cada uno de los siguientes ficheros/directorios:
```bash
cron.d:
```
Contiene archivos de configuración que permiten a administradores añadir tareas de cron sin editar el crontab global. Aquí, en las líneas de las tareas se debe incluir el username.
```bash
cron.allow:
```
Contiene la lista de usuarios a los que se les permite usar crontab.
```bash
cron.deny:
```
Contiene la lista de usuarios a los que no se les permite usar crontab.
```bash
cron.daily:
```
Las tareas que se guarden en cron.daily son las que se ejecutarán diariamente.
```bash
cron.hourly:
```
Las tareas que se guarden en cron.hourly son las que se ejecutarán cada hora.
```bash
cron.monthly:
```
Las tareas que se guarden en cron.monthly son las que se ejecutarán cada mes.